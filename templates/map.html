{% load static %}
<!DOCTYPE html>
<html>
  <head>
    <meta charset="utf-8" />
    <meta http-equiv="X-UA-Compatible" content="IE=edge" />
    <script src="https://api.mapbox.com/mapbox-gl-js/v2.10.0/mapbox-gl.js"></script>
    <link
      href="https://api.mapbox.com/mapbox-gl-js/v2.10.0/mapbox-gl.css"
      rel="stylesheet"
    />
    <script src="https://api.mapbox.com/mapbox-gl-js/plugins/mapbox-gl-directions/v4.1.0/mapbox-gl-directions.js"></script>
    <link
      rel="stylesheet"
      href="https://api.mapbox.com/mapbox-gl-js/plugins/mapbox-gl-directions/v4.1.0/mapbox-gl-directions.css"
      type="text/css"
    />

    <script src="https://api.mapbox.com/mapbox-gl-js/plugins/mapbox-gl-geocoder/v4.7.0/mapbox-gl-geocoder.min.js"></script>
    <link
      rel="stylesheet"
      href="https://api.mapbox.com/mapbox-gl-js/plugins/mapbox-gl-geocoder/v4.7.0/mapbox-gl-geocoder.css"
      type="text/css"
    />
      <script src='https://npmcdn.com/@turf/turf/turf.min.js'></script>
    <link rel="stylesheet" href="{% static 'css/mapPage.css' %}" />
    <link href="https://fonts.googleapis.com/css2?family=Poppins:wght@400;500;600;700&display=swap" rel="stylesheet">
    <title>Interactive Maps</title>
    <meta name="viewport" content="width=device-width, initial-scale=1" />

    <style>
      * {
        transition: all 0.3s ease;
      }
      body {
        font-family: 'Poppins';
      }
      
      .modeItem {
        display:flex;
        flex-direction: row;
        align-items: center;
        justify-content: space-between;
        border:1px solid #eeeeee;
        border-radius:8px;
        padding:10px 15px;
        margin-bottom:10px;
      }
      .modeItem div {
        font-size:14px;
      }
      .sidebarLabel {
        font-size:12px;
        font-weight:600;
        margin-bottom:10px;
      }
      .specialAdd {
        display:flex;
        flex-direction: row;
        justify-content: space-between;
        margin-top:20px;
      }
      input[type="range"] {
        width:100%;
      }
      .locationItem {
        padding:10px 15px;
        border:1px solid #eeeeee;
        border-radius:8px;
        margin-bottom:10px;
        display:block;
        width:100%;
        text-align: left;
        position:relative;
      }

      .findButton {
        background-color:#000000;
        border-radius:8px;
        margin-top:0px;
        color:#FFFFFF;
        width:100%;
        padding:0px 20px;
        border-width:0px;
        display:flex;
        flex-direction: row;
        align-items: center;
        justify-content: center;
      }
      .sidebar {
        padding: 20px;
        padding-top: 0px;
        width: 300px;
        box-shadow: 0px 15px 6px rgb(0 0 0 / 30%);
        border-top: 1px solid #eee;
        opacity:1;
        overflow: auto;
        height: 100vh;
      }
      .menuOff .sidebar {
        opacity:0;
        pointer-events: none;
      }
      .locationItem.active {
        border:2px solid #0275ff;
        background-color:#FFFFFF;
        color: #0275ff;
      }
      .locationItem.active .locationDecor {
        position:absolute;
        right:12px;
        top:0px;
        bottom:0px;
        margin:auto;
        border-radius:999px;
        background-color:#0275ff;
        width:16px;
        height:16px;
        
      }
      .locationItem.active .locationDecor div {
        background-image:url('https://i.ibb.co/d4vdxNh/check.png');
        background-repeat: no-repeat;
        width: 16px;
        height: 16px;
        border-radius: 999px;
        background-size: 10px;
        background-position: center;
      }

      .findDecor {
        width:30px;height:40px;
        display:flex;
        align-items: center;
        justify-content: center;
        position:relative;
      }
      .fdGroup {
        display:flex;
        flex-direction: row;
        align-items: center;
        justify-content: space-between;
        width:12px;
        height:18px;
        position:absolute;
      }
      .find.one , .find.two {
        width:4px;
        height:1px;
        border-radius:1px;
        background-color:#FFFFFF;;
      }
      .fdGroup.two {
        transform:rotate(90deg);
      }
      .menuLine {
        width:20px;height:1px;background-color:#000000;
        transform:rotate(45deg);
        margin-top:1px;
      }
      .menuLine.two {
        transform:rotate(-45deg);
        margin-top:-1px;
      }
      .menuOff .menuLine {
        margin-top:0px;
        transform:rotate(0deg);
      }
      .menuOff .menuLine.two {
        margin-top:8px;
        transform:rotate(0deg);
      }
      

    </style>
  </head>
  <body id="canvas">
    <header style="padding:20px;align-items: center;height:initial;position">
      
      <div style="display:flex;align-items: center;">
        <button id="openMenu" class="openbtn" onclick="openClose()" style="background-color:#FFFFFF;border-width:0px;width:40px;height:40px;box-shadow:0px 0px 6px rgba(0,0,0,0.15);display:flex;flex-direction: column;justify-content: center;align-items: center;position:initial;margin-right:20px;">
          <div class="menuLine one"></div>
          <div class="menuLine two"></div>
        </button>
      <h1>
        <a href="{% url 'home' %}" class="home">
          <div class="logo one">Ascent+</div>
          <div class="logo two">Interactive</div>
        </a>
      </h1>
      </div>
      <div class="pages">
        <a href="{% url 'home' %}" class="page-link">Home</a>
        <a href="{% url 'map' %}" class="page-link">Map</a>
        <a href="{% url 'aboutme' %}" class="page-link">About</a>
      </div>
    
    </header>

    
    <div id ="mySidebar" class="sidebar" style="padding:20px;padding-top:0px;width:300px;">
      <div id="menu">
        <div class="sidebarLabel" style="margin-top:15px;">Map Mode</div>

        <label for="streets-v11" class="modeItem">
          <div>Streets</div>
          <input
            id="streets-v11"
            type="radio"
            name="rtoggle"
            value="streets"
            checked="checked"
          />
        <!-- See a list of Mapbox-hosted public styles at -->
        <!-- https://docs.mapbox.com/api/maps/styles/#mapbox-styles -->
        </label>

        <label for="light-v10" class="modeItem">
          <div>Light</div>
          <input id="light-v10" type="radio" name="rtoggle" value="light" />
        </label>

        <label for="dark-v10" class="modeItem">
          
          <div>Dark</div>
          <input id="dark-v10" type="radio" name="rtoggle" value="dark" />
        </label>

        <label for="navigation-night-v1" class="modeItem">
          <div>Night</div>
          <input
            id="navigation-night-v1"
            type="radio"
            name="rtoggle"
            value="night"
          />
        </label>

        


        <div class="specialAdd">
          <div class="sidebarLabel">Search Radius</div>
          <div style="display:flex;flex-direction: row;align-items: center;">
            <input id="radius-input" type="number" min="1" max="10" value="3" style="border-color:transparent;padding:0px;height:initial;text-align:right;appearance: none;margin-right:-10px;">
            <div style="font-size:12px;"> km</div>
          </div>
        </div>
        
        <div class="radius-slider-container">
          <input type="range" min="1" max="10" value="3" id="radius-slider">
        </div>

        <div class="sidebarLabel" style="margin-top:10px;">Location</div>
        <button id="button1" class="locationItem" onclick="showmarker()">Grocery Stores
          <div class="locationDecor"><div class="locationDecorInner"></div></div>
        </button>
        <button id="button2" class="locationItem" onclick="showmarker2()">Farmers Markets
          <div class="locationDecor"><div class="locationDecorInner"></div></div>
        </button>
        <button id="button3" class="locationItem" onclick="showmarker3()">Fire Stations
          <div class="locationDecor"><div class="locationDecorInner"></div></div>
        </button>

       <div class="sidebarLabel" style="margin-top:10px;">HeatMap</div>
       <button id="heatmap1"  class="locationItem" onclick="groceryheatmap()">Grocery Store Heatmap
        <div class="locationDecor"><div class="locationDecorInner"></div></div>
      </button>
       <button id="heatmap2" class="locationItem" onclick="farmerheatmap()">Farmers Markets Heatmap
        <div class="locationDecor"><div class="locationDecorInner"></div></div>
      </button>
       <button id="heatmap3" class="locationItem" onclick="fireheatmap()">Fire Stations Heatmap
        <div class="locationDecor"><div class="locationDecorInner"></div></div>
      </button>
       <button id="heatmap4"  class="locationItem" onclick="supermarketheatmap()">Supermarkets Heatmap
        <div class="locationDecor"><div class="locationDecorInner"></div></div>
      </button>
       <button id="heatmap5" class="locationItem" onclick="supercenterheatmap()">Supercenters Heatmap
        <div class="locationDecor"><div class="locationDecorInner"></div></div>
      </button>

      
       <div style="border-top:1px solid #eeeeee;padding-top:20px;margin-top:20px;padding-bottom: 100px;">
        <button id="find_nearest_business_button" class="findButton" onclick="showdirections()">
          <div class="findDecor">
            <div class="fdGroup">
              <div class="find one"></div>
              <div class="find two"></div>
            </div>
            
            <div class="fdGroup two">
              <div class="find one"></div>
              <div class="find two"></div>
            </div>
          </div>
          Find Nearest
        </button>
      
        </div>
      </div>
    </div>
    
    
    
    <div id="main" style="height:calc(100vh - 89px);">
      <div id="map" style="width: 100%; height: 100%; position: relative">
      </div>
    <script>
      let isopen = false;

      function openClose(){
        
        
        isopen= !isopen
        console.log(isopen);
        var d = document.getElementById("canvas");
        d.classList.toggle("menuOff");
        const directionsBox = document.querySelector('.mapboxgl-ctrl-directions');
        
        if(directionsBox!= null){
          if(isopen){
            directionsBox.style.marginLeft = '20px';
          }else{
            directionsBox.style.marginLeft = '320px';
            
          }
          
        }
 
      }
      </script>



    <script>
        const RADIUS_LIMIT = 10;
        let radius_slider = document.getElementById('radius-slider');
        let radius_input = document.getElementById('radius-input');
        let first_change = true;

        radius_slider.addEventListener('change', (e) => {
           radius_input.value = e.target.value;
           if(user_location != null)
           {
               if(first_change)
                {
                    first_change = false;
                    drawUserRadius(user_location, parseFloat(e.target.value));
                }
               let circle = turf.circle(user_location, parseFloat(e.target.value), {units: 'miles'});
               map.getSource('user-radius').setData(circle);
           }
        });
        radius_input.addEventListener('change', (e) => {
            radius_slider.value = e.target.value;
            radius_input.value = e.target.value > RADIUS_LIMIT ? RADIUS_LIMIT : e.target.value;
            if(user_location != null)
            {
                if(first_change)
                {
                    first_change = false;
                    drawUserRadius(user_location, parseFloat(e.target.value));
                }
                let circle = turf.circle(user_location, parseFloat(e.target.value), {units: 'miles'});
                map.getSource('user-radius').setData(circle);
            }
        })
      const bounds = [
        [-75.323541,40.405131], // Southwest coordinates
        [-71.566392,41.411836] // Northeast coordinates
      ];
      mapboxgl.accessToken =
        "pk.eyJ1IjoiaGFtc2llIiwiYSI6ImNsODN4aWdmcjBhNHEzcGw4ZXYxMHcxaXkifQ.67o9saEURWg3rF02gZxGKg";
      const map = new mapboxgl.Map({
        container: "map", // container ID
        style: "mapbox://styles/mapbox/streets-v11?optimize=true", // style URL
        center: [-73.93, 40.73], // starting position [lng, lat]
        zoom: 13, // starting zoom
        maxBounds: bounds
      });

      const layerList = document.getElementById("menu");
      const inputs = layerList.getElementsByTagName("input");

      for (const input of inputs) {
        input.onclick = (layer) => {
          const layerId = layer.target.id;
          map.setStyle("mapbox://styles/mapbox/" + layerId);
        };
      }

      const nav = new mapboxgl.NavigationControl({
        visualizePitch: true,
      });
      map.addControl(nav, "bottom-right");

      map.on("style.load", () => {
        map.setFog({
          color: "rgb(186, 210, 235)", // Lower atmosphere
          "high-color": "rgb(36, 92, 223)", // Upper atmosphere
          "horizon-blend": 0.02, // Atmosphere thickness (default 0.2 at low zooms)
          "space-color": "rgb(11, 11, 25)", // Background color
          "star-intensity": 0.6, // Background star brightness (default 0.35 at low zoooms )
        });
      });

      var geocoder = new MapboxGeocoder({
        // Initialize the geocoder
        accessToken: mapboxgl.accessToken, // Set the access token
        mapboxgl: mapboxgl, // Set the mapbox-gl instance
        marker: false, // Do not use the default marker style
        placeholder: " ",
      });

      // Add the geocoder to the map
      map.addControl(geocoder);
      // After the map style has loaded on the page,
      // add a source layer and default styling for a single point

          var geolocate = new mapboxgl.GeolocateControl({
              positionOptions: {
                  enableHighAccuracy: true
              },
              // When active the map will receive updates to the device's location as it changes.
              trackUserLocation: true,
              // Draw an arrow next to the location dot to indicate which direction the device is heading.
              showUserHeading: true,
              showAccuracyCircle: false,
          })
      var user_location = null;
          function drawUserRadius(user_location, radius) {
              if(typeof map.getLayer('user-radius') === 'undefined') {
              let circle = turf.circle(user_location, radius, {units: 'miles'});
              map.addLayer({
                  "id": "user-radius",
                  "type": "fill",
                  "source": {
                      "type": "geojson",
                      "data": circle
                  },
                  "paint": {
                      "fill-color": "green",
                      "fill-opacity": 0.3
                  }
              });
          }
          }

      geolocate.on('geolocate', (e) => {
          user_location = turf.point([e.coords.longitude, e.coords.latitude]);
      });
          map.addControl(geolocate);

        var directions = new MapboxDirections({
                    accessToken: mapboxgl.accessToken,
                    interactive: false,
                });
    </script>

    
    <!-- TESTING HOW TO RETURN CLOSEST COORDINATE PAIR TO A GIVEN SET OF COORDINATES -->
    
    <!-- <script>
      
        HOW TO ITERATE THROUGH THE FARMERS MARKET DATABASE AND RETRIEVE LONG,LAT OF THE ENTRIES
        ___________________________________________________________________________
        {% for farmer_address in farmer_addresses %} 

        [{{ farmer_address.long }}, {{ farmer_address.lat }}];

        {% endfor %}
        _____________________________________________________________________________
               


        const haversine = ({longitude: lonA, latitude: latA}, {longitude: lonB, latitude: latB}) => {
        const {PI, sin, cos, atan2} = Math,
              r = PI/180,
              R = 6371,
              deltaLat = (latB - latA)*r,
              deltaLon = (lonB - lonA)*r,
              a = sin(deltaLat / 2)**2 + cos(cos(latB*r)*latA*r) * sin(deltaLon /2)**2,
              c = 2 * atan2(a**0.5, (1 - a)**0.5),
              d = R * c
        return d
      },
      

      arr = [{"latitude":55.85,"longitude":4.22},{"latitude":55.89,"longitude":4.16},{"latitude":55.88,"longitude":-4.24}],
      
      {closest} = arr.reduce((r,o) => {
        const distance = haversine(o, obj)
        distance < r.minDistance || !r.closest &&
        (r.closest = o, r.minDistance = distance)
        return r
      }, {closest: null, minDistance: null})
      
console.log(closest) -->
</script>
    <script>
               var marker1showing = false;
               var marker2showing = false;
               var marker3showing = false;
               var directionsshowing = false;
               var marker1s = [];
               var marker2s = [];
               var marker3s = [];
               function showmarker()
               

               {

                var buttonOne = document.getElementById("button1");
                buttonOne.classList.toggle("active")

                

                 if(!marker1showing)
                 {
                     marker1showing = true;
                     {% for address in addresses %} var marker = new
                               mapboxgl.Marker().setLngLat([{{ address.long }}, {{ address.lat }}]).addTo(map); marker1s.push(marker); {% endfor %}
                 }
                 else
                 {
                     marker1showing = false;
                     marker1s.forEach((marker) => marker.remove());
                     marker1s = []
                 }
               };
               function showmarker2(){

                

                var buttonTwo = document.getElementById("button2");
                buttonTwo.classList.toggle("active")
                
                


               if(!marker2showing)
               {
                   marker2showing = true;
                                 {% for farmer_address in farmer_addresses %} var marker = new
                               mapboxgl.Marker({
         color: "#228B22"}).setLngLat([{{ farmer_address.long }}, {{ farmer_address.lat }}]).addTo(map); marker2s.push(marker); {% endfor %}
               }
                 else
                 {
                     marker2showing = false;
                     marker2s.forEach((marker) => marker.remove());
                     marker2s = []
                 }
               };
               function showmarker3(){

                var buttonThree = document.getElementById("button3");
                buttonThree.classList.toggle("active")


               if(!marker3showing)
               {
                   marker3showing = true;
                                 {% for fire_address in fire_addresses %} var marker = new
                               mapboxgl.Marker({
         color: "#FF0000 "}).setLngLat([{{ fire_address.long }}, {{ fire_address.lat }}]).addTo(map); marker3s.push(marker); {% endfor %}
               }
                 else
                 {
                     marker3showing = false;
                     marker3s.forEach((marker) => marker.remove());
                     marker3s = []
                 }
               };

         function showdirections(){
          if(!directionsshowing){
              directionsshowing = true;
            let allMarkers = marker1s.concat(marker2s, marker3s);
            let radius = parseFloat(document.getElementById('radius-input').value);
            let circle_buffer = turf.buffer(user_location, radius, {units: 'miles'});
            var points_in_circle = allMarkers.filter(function (marker) {
                return turf.booleanPointInPolygon(turf.point([marker._lngLat.lng, marker._lngLat.lat]), circle_buffer);
            });
            if(points_in_circle.length > 0)
            {
                let points = turf.featureCollection(points_in_circle.map(marker => {
                    return turf.point([marker._lngLat.lng, marker._lngLat.lat]);
                }));
            let closest_marker = turf.nearestPoint(user_location, points);
              if(user_location != null && closest_marker != null)
              {
                  map.addControl(directions, "top-left");
                  directions.setOrigin(user_location.geometry.coordinates);
                  directions.setDestination(closest_marker.geometry.coordinates);
              }
            }
          }
          else
          {
              directionsshowing = false;
              if(map.hasControl(directions))
              {
                  map.removeControl(directions);
              }
          }
          
        const directionsBox = document.querySelector('.mapboxgl-ctrl-directions');
        directionsBox.style.marginLeft = '320px';
          
        
        }
    </script>

<script>


  function groceryheatmap(){
  
  
  
  
  map.addSource('grocery-stores-heatmap', {
  'type': 'vector',
  'url': 'mapbox://arielb1.38i7mvbz'
  });
   
  map.addLayer(
  {
  'id': 'grocery-stores-heat',
  'type': 'heatmap',
  'source': 'grocery-stores-heatmap',
  'source-layer': 'Total_grocery_stores-6tzhl7',
  'maxzoom': 22,
  'paint': {
  
  'heatmap-weight': .8,
  'heatmap-intensity': 1.1,
  // Color ramp for heatmap.  Domain is 0 (low) to 1 (high).
  // Begin color ramp at 0-stop with a 0-transparancy color
  // to create a blur-like effect.
  'heatmap-color': [
        "interpolate",
        ["linear"],
        ["heatmap-density"],
        0,
        "rgba(0, 0, 255, 0)",
        0.1,
        "royalblue",
        0.3,
        "cyan",
        0.5,
        "lime",
        0.7,
        "yellow",
        1,
        "red"
      ],
  'heatmap-radius': [
        "interpolate",
        ["linear"],
        ["zoom"],
        0,
        5,
        22,
        30
      ],
  // Transition from heatmap to circle layer by zoom level
  'heatmap-opacity':1
  }
  },
  
  );
   
  map.addLayer(
  {
  'id': 'grocery-stores-point',
  'type': 'circle',
  'source': 'grocery-stores-heatmap',
  'source-layer': 'Total_grocery_stores-6tzhl7',
  'minzoom': 1,
  'paint': {
  
  'circle-radius': 3,
  
  'circle-color': [
  'interpolate',
  ['linear'],
  ['get', 'Square Footage'],
  1,
  'rgba(33,102,172,0)',
  2,
  'rgb(103,169,207)',
  3,
  'rgb(209,229,240)',
  4,
  'rgb(253,219,199)',
  5,
  'rgb(239,138,98)',
  6,
  'rgb(178,24,43)'
  ],
  'circle-stroke-color': 'white',
  'circle-stroke-width': 1,
  // Transition from heatmap to circle layer by zoom level
  'circle-opacity':2
  }
   },
  
  );
  }
  
  function farmerheatmap(){
  
  
  
  
  map.addSource('farmers-markets-heatmap', {
  'type': 'vector',
  'url': 'mapbox://arielb1.af9vybob'
  });
   
  map.addLayer(
  {
  'id': 'farmers-markets-heat',
  'type': 'heatmap',
  'source': 'farmers-markets-heatmap',
  'source-layer': 'DOHMH_Farmers_Markets-ccwyus',
  'maxzoom': 22,
  'paint': {
  
  'heatmap-weight': .8,
  'heatmap-intensity': 1.1,
  // Color ramp for heatmap.  Domain is 0 (low) to 1 (high).
  // Begin color ramp at 0-stop with a 0-transparancy color
  // to create a blur-like effect.
  'heatmap-color': [
        "interpolate",
        ["linear"],
        ["heatmap-density"],
        0,
        "rgba(0, 0, 255, 0)",
        0.1,
        "royalblue",
        0.3,
        "cyan",
        0.5,
        "lime",
        0.7,
        "yellow",
        1,
        "red"
      ],
  'heatmap-radius': [
        "interpolate",
        ["linear"],
        ["zoom"],
        0,
        5,
        22,
        30
      ],
  // Transition from heatmap to circle layer by zoom level
  'heatmap-opacity':1
  }
  },
  
  );
   
  map.addLayer(
  {
  'id': 'farmers-markets-point',
  'type': 'circle',
  'source': 'farmers-markets-heatmap',
  'source-layer': 'DOHMH_Farmers_Markets-ccwyus',
  'minzoom': 1,
  'paint': {
  
  'circle-radius': 3,
  
  'circle-color': [
  'interpolate',
  ['linear'],
  ['get', 'Square Footage'],
  1,
  'rgba(33,102,172,0)',
  2,
  'rgb(103,169,207)',
  3,
  'rgb(209,229,240)',
  4,
  'rgb(253,219,199)',
  5,
  'rgb(239,138,98)',
  6,
  'rgb(178,24,43)'
  ],
  'circle-stroke-color': 'white',
  'circle-stroke-width': 1,
  // Transition from heatmap to circle layer by zoom level
  'circle-opacity':2
  }
   },
  
  );
  }
  
  function fireheatmap(){
  
  
  
  
  map.addSource('fire-station-heatmap', {
  'type': 'vector',
  'url': 'mapbox://arielb1.388xpmrj'
  });
   
  map.addLayer(
  {
  'id': 'fire-station-heat',
  'type': 'heatmap',
  'source': 'fire-station-heatmap',
  'source-layer': 'FDNY_Firehouse_Listing-4hvksv',
  'maxzoom': 22,
  'paint': {
  
  'heatmap-weight': .8,
  'heatmap-intensity': 1.1,
  // Color ramp for heatmap.  Domain is 0 (low) to 1 (high).
  // Begin color ramp at 0-stop with a 0-transparancy color
  // to create a blur-like effect.
  'heatmap-color': [
        "interpolate",
        ["linear"],
        ["heatmap-density"],
        0,
        "rgba(0, 0, 255, 0)",
        0.1,
        "royalblue",
        0.3,
        "cyan",
        0.5,
        "lime",
        0.7,
        "yellow",
        1,
        "red"
      ],
  'heatmap-radius': [
        "interpolate",
        ["linear"],
        ["zoom"],
        0,
        5,
        22,
        30
      ],
  // Transition from heatmap to circle layer by zoom level
  'heatmap-opacity':1
  }
  },
  
  );
   
  map.addLayer(
  {
  'id': 'fire-station-point',
  'type': 'circle',
  'source': 'fire-station-heatmap',
  'source-layer': 'FDNY_Firehouse_Listing-4hvksv',
  'minzoom': 1,
  'paint': {
  
  'circle-radius': 3,
  
  'circle-color': [
  'interpolate',
  ['linear'],
  ['get', 'Square Footage'],
  1,
  'rgba(33,102,172,0)',
  2,
  'rgb(103,169,207)',
  3,
  'rgb(209,229,240)',
  4,
  'rgb(253,219,199)',
  5,
  'rgb(239,138,98)',
  6,
  'rgb(178,24,43)'
  ],
  'circle-stroke-color': 'white',
  'circle-stroke-width': 1,
  // Transition from heatmap to circle layer by zoom level
  'circle-opacity':2
  }
   },
  
  );
  }
  
  function supermarketheatmap(){
  
  
  
  
  map.addSource('super-markets-heatmap', {
  'type': 'vector',
  'url': 'mapbox://arielb1.dftl2j6f'
  });
   
  map.addLayer(
  {
  'id': 'super-markets-heat',
  'type': 'heatmap',
  'source': 'super-markets-heatmap',
  'source-layer': 'Supermarkets-52ltms',
  'maxzoom': 22,
  'paint': {
  
  'heatmap-weight': .8,
  'heatmap-intensity': 1.1,
  // Color ramp for heatmap.  Domain is 0 (low) to 1 (high).
  // Begin color ramp at 0-stop with a 0-transparancy color
  // to create a blur-like effect.
  'heatmap-color': [
        "interpolate",
        ["linear"],
        ["heatmap-density"],
        0,
        "rgba(0, 0, 255, 0)",
        0.1,
        "royalblue",
        0.3,
        "cyan",
        0.5,
        "lime",
        0.7,
        "yellow",
        1,
        "red"
      ],
  'heatmap-radius': [
        "interpolate",
        ["linear"],
        ["zoom"],
        0,
        5,
        22,
        30
      ],
  // Transition from heatmap to circle layer by zoom level
  'heatmap-opacity':1
  }
  },
  
  );
   
  map.addLayer(
  {
  'id': 'super-markets-point',
  'type': 'circle',
  'source': 'super-markets-heatmap',
  'source-layer': 'Supermarkets-52ltms',
  'minzoom': 1,
  'paint': {
  
  'circle-radius': 3,
  
  'circle-color': [
  'interpolate',
  ['linear'],
  ['get', 'Square Footage'],
  1,
  'rgba(33,102,172,0)',
  2,
  'rgb(103,169,207)',
  3,
  'rgb(209,229,240)',
  4,
  'rgb(253,219,199)',
  5,
  'rgb(239,138,98)',
  6,
  'rgb(178,24,43)'
  ],
  'circle-stroke-color': 'white',
  'circle-stroke-width': 1,
  // Transition from heatmap to circle layer by zoom level
  'circle-opacity':2
  }
   },
  
  );
  }
  
  function supercenterheatmap(){
  
  
  
  
  map.addSource('super-center-heatmap', {
  'type': 'vector',
  'url': 'mapbox://arielb1.bx5tiqmq'
  });
   
  map.addLayer(
  {
  'id': 'super-center-heat',
  'type': 'heatmap',
  'source': 'super-center-heatmap',
  'source-layer': 'Supercenters-49gbzn',
  'maxzoom': 22,
  'paint': {
  
  'heatmap-weight': .8,
  'heatmap-intensity': 1.1,
  // Color ramp for heatmap.  Domain is 0 (low) to 1 (high).
  // Begin color ramp at 0-stop with a 0-transparancy color
  // to create a blur-like effect.
  'heatmap-color': [
        "interpolate",
        ["linear"],
        ["heatmap-density"],
        0,
        "rgba(0, 0, 255, 0)",
        0.1,
        "royalblue",
        0.3,
        "cyan",
        0.5,
        "lime",
        0.7,
        "yellow",
        1,
        "red"
      ],
  'heatmap-radius': [
        "interpolate",
        ["linear"],
        ["zoom"],
        0,
        5,
        22,
        30
      ],
  // Transition from heatmap to circle layer by zoom level
  'heatmap-opacity':1
  }
  },
  
  );
   
  map.addLayer(
  {
  'id': 'super-center-point',
  'type': 'circle',
  'source': 'super-center-heatmap',
  'source-layer': 'Supercenters-49gbzn',
  'minzoom': 1,
  'paint': {
  
  'circle-radius': 3,
  
  'circle-color': [
  'interpolate',
  ['linear'],
  ['get', 'Square Footage'],
  1,
  'rgba(33,102,172,0)',
  2,
  'rgb(103,169,207)',
  3,
  'rgb(209,229,240)',
  4,
  'rgb(253,219,199)',
  5,
  'rgb(239,138,98)',
  6,
  'rgb(178,24,43)'
  ],
  'circle-stroke-color': 'white',
  'circle-stroke-width': 1,
  // Transition from heatmap to circle layer by zoom level
  'circle-opacity':2
  }
   },
  
  );
  }
  
  
  
  
  
  
  
  </script>
  </body>
</html>
